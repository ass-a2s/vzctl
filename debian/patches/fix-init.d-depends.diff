Index: new/etc/init.d/vz-redhat.in
===================================================================
--- new.orig/etc/init.d/vz-redhat.in	2012-02-10 06:40:03.000000000 +0100
+++ new/etc/init.d/vz-redhat.in	2012-04-20 09:20:53.000000000 +0200
@@ -25,8 +25,8 @@
 
 ### BEGIN INIT INFO
 # Provides: vz
-# Required-start: $network $remote_fs $syslog
-# Required-stop:  $network $remote_fs $syslog
+# Required-Start: +iscsi pve-cluster cman clvm $network $local_fs $remote_fs $syslog
+# Required-Stop:  +iscsi pve-cluster cman clvm $network $local_fs $remote_fs $syslog
 # Should-Start:  sshd vzeventd
 # Should-Stop:  sshd vzeventd
 # Default-Start: 2 3 4 5
@@ -40,6 +40,7 @@
 
 . @VZLIBDIR@/initd-functions
 
+PVECTL=/usr/bin/pvectl
 VZQUOTA=@SBINDIR@/vzquota
 CONFIG_DIR=@VPSCONFDIR@
 LOCKFILE=$VARLOCK/vz_lock
@@ -270,10 +271,17 @@
 	local msg
 	local need_restart
 
+	sysctl -q -w net.ipv4.route.src_check=0
+
+	if [ -x ${PVECTL} ]; then
+	    # pve-manager should start the containers
+	    return;
+	fi
+
 	need_restart=""
 	velist=$(vzlist -aH -octid,onboot -s-bootorder |
 		awk '$2 == "yes" {print $1}')
-	sysctl -q -w net.ipv4.route.src_check=0
+
 	for veid in $velist; do
 		[ "${veid}" = "0" ] && continue
 		__echo "Starting CT ${veid}: "
